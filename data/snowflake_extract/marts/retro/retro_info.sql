{{ config(
    materialized='table'
) }}

SELECT 
    FT.USER_NAME AS USER_NAME
    , FT.CUSTOMER_ID
    , FT.FAVORITE_TEAM_1
    , FT.FAVORITE_TEAM_2
    , FT.FAVORITE_TEAM_3
    , FT.FAVORITE_TEAM_4
    , FT.FAVORITE_TEAM_5
    , FT.NB_BET_FAVORITE_TEAM_1
    , FT.NB_BET_FAVORITE_TEAM_2
    , FT.NB_BET_FAVORITE_TEAM_3
    , FT.NB_BET_FAVORITE_TEAM_4
    , FT.NB_BET_FAVORITE_TEAM_5

    , LFT.LEAST_FAVORITE_TEAM_1
    , LFT.NB_BET_LEAST_FAVORITE_TEAM_1

    , BW.BIGGEST_WIN_1::NUMBER(38,0) AS BIGGEST_WIN_1
    , BW.BIGGEST_WIN_2::NUMBER(38,0) AS BIGGEST_WIN_2
    , BW.BIGGEST_WIN_3::NUMBER(38,0) AS BIGGEST_WIN_3
    , BW.BIGGEST_WIN_4::NUMBER(38,0) AS BIGGEST_WIN_4
    , BW.BIGGEST_WIN_5::NUMBER(38,0) AS BIGGEST_WIN_5
    , BW.DATE_BIGGEST_WIN_1
    , BW.DATE_BIGGEST_WIN_2
    , BW.DATE_BIGGEST_WIN_3
    , BW.DATE_BIGGEST_WIN_4
    , BW.DATE_BIGGEST_WIN_5 
    , BW.NB_SELECTION_BIGGEST_WIN_1
    , BW.NB_SELECTION_BIGGEST_WIN_2
    , BW.NB_SELECTION_BIGGEST_WIN_3
    , BW.NB_SELECTION_BIGGEST_WIN_4
    , BW.NB_SELECTION_BIGGEST_WIN_5
    , BO.BIGGEST_ODD_1
    , BO.BIGGEST_ODD_2
    , BO.BIGGEST_ODD_3
    , BO.BIGGEST_ODD_4
    , BO.BIGGEST_ODD_5
    , BO.DATE_BIGGEST_ODD_1
    , BO.DATE_BIGGEST_ODD_2
    , BO.DATE_BIGGEST_ODD_3
    , BO.DATE_BIGGEST_ODD_4
    , BO.DATE_BIGGEST_ODD_5
    , BO.NB_SELECTION_BIGGEST_ODD_1
    , BO.NB_SELECTION_BIGGEST_ODD_2
    , BO.NB_SELECTION_BIGGEST_ODD_3
    , BO.NB_SELECTION_BIGGEST_ODD_4
    , BO.NB_SELECTION_BIGGEST_ODD_5 
    , LT.LUCKIEST_TEAM_1
    , LT.LUCKIEST_TEAM_2
    , LT.LUCKIEST_TEAM_3
    , LT.LUCKIEST_TEAM_4
    , LT.LUCKIEST_TEAM_5
    , LT.WIN_RATE_LUCKIEST_TEAM_1
    , LT.WIN_RATE_LUCKIEST_TEAM_2
    , LT.WIN_RATE_LUCKIEST_TEAM_3
    , LT.WIN_RATE_LUCKIEST_TEAM_4
    , LT.WIN_RATE_LUCKIEST_TEAM_5
    , DB.BEST_DAY_DATE_1
    , DB.BEST_DAY_DATE_2
    , DB.BEST_DAY_DATE_3
    , DB.BEST_DAY_DATE_4
    , DB.BEST_DAY_DATE_5
    , DB.BEST_DAY_WIN_AMOUNT_1 
    , DB.BEST_DAY_WIN_AMOUNT_2 
    , DB.BEST_DAY_WIN_AMOUNT_3 
    , DB.BEST_DAY_WIN_AMOUNT_4 
    , DB.BEST_DAY_WIN_AMOUNT_5 
    , DB.BEST_DAY_NB_BET_1 
    , DB.BEST_DAY_NB_BET_2 
    , DB.BEST_DAY_NB_BET_3 
    , DB.BEST_DAY_NB_BET_4 
    , DB.BEST_DAY_NB_BET_5 
    
FROM {{ ref('retro_favorite_team') }} AS FT 
LEFT JOIN {{ ref('retro_loosing_team') }} AS LFT
    ON FT.CUSTOMER_ID = LFT.CUSTOMER_ID
LEFT JOIN {{ ref('stg_biggest_win') }} AS BW 
    ON FT.CUSTOMER_ID = BW.CUSTOMER_ID
LEFT JOIN {{ ref('stg_biggest_odd') }} AS BO 
    ON FT.CUSTOMER_ID = BO.CUSTOMER_ID
LEFT JOIN {{ ref('stg_retro_lucky_team') }} AS LT 
    ON FT.CUSTOMER_ID = LT.CUSTOMER_ID
LEFT JOIN {{ ref('stg_best_day') }} AS DB
    ON FT.CUSTOMER_ID = DB.CUSTOMER_ID
--WHERE FT.USER_NAME in ('TESTBC_CAMREV', 'TESTBC_STESEGU', 'TESTBC_THIIOZZ')